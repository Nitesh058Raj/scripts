From da620b29a4a53794d6930c4af1f3866ef6b7a86c Mon Sep 17 00:00:00 2001
From: Krzesimir Nowak <knowak@microsoft.com>
Date: Tue, 27 Feb 2024 16:25:12 +0100
Subject: [PATCH 15/20] sysext: Add sample configuration file

---
 src/sysext/extensions.conf | 23 +++++++++++++++++++++++
 src/sysext/meson.build     |  5 +++++
 2 files changed, 28 insertions(+)
 create mode 100644 src/sysext/extensions.conf

diff --git a/src/sysext/extensions.conf b/src/sysext/extensions.conf
new file mode 100644
index 0000000000..57c77b98eb
--- /dev/null
+++ b/src/sysext/extensions.conf
@@ -0,0 +1,23 @@
+#  This file is part of systemd.
+#
+#  systemd is free software; you can redistribute it and/or modify it under the
+#  terms of the GNU Lesser General Public License as published by the Free
+#  Software Foundation; either version 2.1 of the License, or (at your option)
+#  any later version.
+#
+# Entries in this file show the compile time defaults. Local configuration
+# should be created by either modifying this file (or a copy of it placed in
+# /etc/ if the original file is shipped in /usr/), or by creating "drop-ins" in
+# the /etc/systemd/extensions.conf.d/ directory. The latter is generally
+# recommended. Defaults can be restored by simply deleting the main
+# configuration file and all drop-ins located in /etc/.
+#
+# Use 'systemd-analyze cat-config systemd/extensions.conf' to display the full config.
+#
+# See extensions.conf(5) for details
+
+[Sysext]
+#Mutable=no
+
+[Confext]
+#Mutable=no
diff --git a/src/sysext/meson.build b/src/sysext/meson.build
index 2983970d80..05cc55e952 100644
--- a/src/sysext/meson.build
+++ b/src/sysext/meson.build
@@ -12,4 +12,9 @@ executables += [
 if conf.get('ENABLE_SYSEXT') == 1
         meson.add_install_script(sh, '-c', ln_s.format(bindir / 'systemd-sysext',
                                                        bindir / 'systemd-confext'))
+
+        if install_sysconfdir_samples
+                install_data('extensions.conf',
+                             install_dir : pkgconfigfiledir)
+        endif
 endif
-- 
2.34.1

